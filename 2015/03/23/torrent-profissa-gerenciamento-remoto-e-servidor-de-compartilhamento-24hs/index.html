<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Torrent profissa: gerenciamento remoto e servidor de compartilhamento 24hs | $ls /home/felipehw</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="O Transmission é um cliente de torrent bastante conhecido no mundo GNU&#x2F;Linux. Entretanto, há muitas pessoas que desconhecem que ele pode ser usado como um serviço (daemon) subindo sempre que a máquina">
<meta property="og:type" content="article">
<meta property="og:title" content="Torrent profissa: gerenciamento remoto e servidor de compartilhamento 24hs">
<meta property="og:url" content="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/index.html">
<meta property="og:site_name" content="$ls &#x2F;home&#x2F;felipehw">
<meta property="og:description" content="O Transmission é um cliente de torrent bastante conhecido no mundo GNU&#x2F;Linux. Entretanto, há muitas pessoas que desconhecem que ele pode ser usado como um serviço (daemon) subindo sempre que a máquina">
<meta property="og:locale" content="pt_BR">
<meta property="og:image" content="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/copying_is_not_theft_min.jpg">
<meta property="og:image" content="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/transmission_com_https_via_browser.png">
<meta property="article:published_time" content="2015-03-24T01:29:26.000Z">
<meta property="article:modified_time" content="2015-10-06T23:57:52.830Z">
<meta property="article:author" content="felipehw">
<meta property="article:tag" content="debian">
<meta property="article:tag" content="compartilhamento">
<meta property="article:tag" content="pirataria">
<meta property="article:tag" content="torrent">
<meta property="article:tag" content="raspberry">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/copying_is_not_theft_min.jpg">
  
    <link rel="alternate" href="/atom.xml" title="$ls /home/felipehw" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title">
      <img id="header-logo" src="/images/tux_v02.svg.png" alt="Tux pixelated" title="Tux pixelated">
      <div id="header-wrap-hs">
        <h1 id="logo-wrap">
          <a href="/" id="logo">$ls /home/felipehw</a>
        </h1>
        
          <h2 id="subtitle-wrap">
            <a href="/" id="subtitle">software &amp; cultura livre</a>
          </h2>
        
      </div>
    </div>
    <div id="header-inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://felipehw.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/" class="article-date">
  <time class="dt-published" datetime="2015-03-24T01:29:26.000Z" itemprop="datePublished">23 mar 2015</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cultura-livre/">cultura livre</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Torrent profissa: gerenciamento remoto e servidor de compartilhamento 24hs
    </h1>
  


      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>O <a href="http://www.transmissionbt.com" target="_blank" rel="noopener">Transmission</a> é um cliente de torrent bastante conhecido no mundo GNU/Linux. Entretanto, há muitas pessoas que desconhecem que ele pode ser usado como um serviço (daemon) subindo sempre que a máquina está ligada e sem necessitar de interface gráfica para gerenciá-lo (pode ser gerenciado remotamente via browser, cli, gtk, etc.).</p>
<p>Se combinamos o serviço do Transmission com um <a href="http://www.raspberrypi.org/" target="_blank" rel="noopener">Raspberry Pi</a> baratinho, temos um servidor de compartilhar <del>pirataria</del> cultura 24 horas por dia que pode ser acessado remotamente via browser e gastando um ínfimo de energia.</p>
<img src="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/copying_is_not_theft_min.jpg" class="" title="Copying Is Not Theft - Nina Paley">

<a id="more"></a>

<p>A única “carência” do daemon do Transmission é que o mesmo só suporta protocolo HTTP, ou seja, sua senha para gerenciar os torrents trafega em <em>text plain</em>. Coloquei carência entre “” pq é uma opção dos desenvolvedores, os mesmos consideram que seu dever é fazer um cliente de torrent eficiente, a parte da criptografia pode ser feita com mais qualidade e segurança usando algum software complementar. No nosso caso, garantiremos uma conexão segura implementando HTTPS via servidor <a href="http://nginx.org/" target="_blank" rel="noopener">Nginx</a>.</p>
<p>Veremos primeiro como configurar o daemon Transmission e, opcionalmente, como aplicar HTTPS à conexão remota via Nginx.</p>
<p><strong>Obs</strong>: Nesse tutorial é usado o Debian Jessie. Provavelmente pode ser aplicado à outras distros <em>Debian like</em> sem muita adaptação.</p>
<h2 id="Subindo-seu-proprio-transmission-daemon"><a href="#Subindo-seu-proprio-transmission-daemon" class="headerlink" title="Subindo seu próprio transmission-daemon"></a>Subindo seu próprio <em>transmission-daemon</em></h2><h3 id="0-Instalacao"><a href="#0-Instalacao" class="headerlink" title="0. Instalação"></a>0. Instalação</h3><p>Instale o daemon do Transmission:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get install transmission-daemon</span></span><br></pre></td></tr></table></figure>

<p>Junto com o daemon é instalado o pacote <code>transmission-cli</code>, que possibilita interagir com o daemon desde o prompt. Entretanto, o mesmo pode ser ignorado porque é possível gerenciar o daemon desde o browser (ou cliente gráfico como o <code>transmission-remote-gtk</code>).</p>
<h3 id="1-Configuracao"><a href="#1-Configuracao" class="headerlink" title="1. Configuração"></a>1. Configuração</h3><h4 id="1-1-Arquivos-do-transmission-daemon"><a href="#1-1-Arquivos-do-transmission-daemon" class="headerlink" title="1.1. Arquivos do transmission-daemon"></a>1.1. Arquivos do <em>transmission-daemon</em></h4><p>Os arquivos referentes ao daemon estão localizados no dir <code>/var/lib/transmission-daemon</code> em sistemas Debian. Temos, principalmente, os seguintes diretórios/arquivos:</p>
<ul>
<li><code>downloads/</code>: Dir padrão p/ download de torrent (definiremos outro).</li>
<li><code>info/settings.json</code>: Arquivo de configuração (link p/ <code>/etc/transmission-daemon/settings.json</code>)</li>
<li><code>info/stats.json</code>: Arquivo que reúne estatísticas da sessão (como quantia de download/upload).</li>
<li><code>info/torrents</code>: Armazena os arquivos <code>.torrent</code> adicionados para download.</li>
<li><code>info/resume</code>: Armazena info. sobre downloads em andamanento (partes baixadas, path, etc.).</li>
</ul>
<h4 id="1-2-Editando-settings-json"><a href="#1-2-Editando-settings-json" class="headerlink" title="1.2. Editando settings.json:"></a>1.2. Editando <code>settings.json</code>:</h4><p>O arquivo com todas as configurações é <code>settings.json</code>. Editar o mesmo provavelmente exigirá permissões de <em>root</em>.</p>
<p>Recomendo que seja criado uma cópia da versão original, por via das dúvidas :D.</p>
<p>O arquivo utiliza a sintaxe <a href="https://pt.wikipedia.org/wiki/JSON" target="_blank" rel="noopener">JSON</a>. É uma sintaxe muito fácil de ser lida, mas que exige atenção ao editar. Qualquer <code>,</code>, <code>:</code> ou <code>&quot;</code> fora do lugar e o daemon não subirá. Ajuda bastante usar um parser online como esse <a href="http://jsonformatter.curiousconcept.com/" target="_blank" rel="noopener">aqui</a>, onde você pode colar seu arquivo de configuração e ver se colocou algo fora do lugar que viola a sintaxe.</p>
<p><strong>Atenção</strong>: Após a instalação, o daemon estará em execução e ao parar de executar, sobrescreverá qualquer mudança que possa ter ocorrido em <code>settings.json</code> enquanto estava rodando. Por isso, devemos parar o daemon:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl stop transmission-daemon</span></span><br></pre></td></tr></table></figure>

<p>Verifique se o daemon realmente parou:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status transmission-daemon</span></span><br></pre></td></tr></table></figure>

<p>Maõs à obra!</p>
<p>O arquivo <code>settings.json</code> original vem com diversas configurações padrões. Alterei menos de 20 linhas e dessas eram realmente necessárias menos de 10. Começarei pelas que acho mais relevantes e citarei 4 à parte que considero menos interessantes mas que podem ser úteis para pessoas com roteadores mais fracos que podem ficar sobrecarregados por muitas conexões abertas pelo Transmission.</p>
<p>Configurações para alterar em <code>settings.json</code>:</p>
<ul>
<li><code>&quot;download-dir&quot;:</code> <del><code>&quot;/var/lib/transmission-daemon/downloads&quot;</code></del> <code>&quot;/dir/dos_downloads_quiridus&quot;</code>:<br>Onde colocar os downloads.</li>
<li><code>&quot;port-forwarding-enabled&quot;:</code> <del><code>false</code></del> <code>true</code><br>Habilitar encaminhamento de porta, útil para conexões atrás de NAT (comum em residências, se vc não sabe … habilite).</li>
<li><code>&quot;ratio-limit&quot;:</code> <del><code>2</code></del> <code>5</code><br>Taxa de compartilhamento … tás montando um server p/ torrents … aumente isso que 2 é pouco.</li>
<li><code>&quot;ratio-limit-enabled&quot;:</code> <del><code>false</code></del> <code>true</code><br>P/ aplicar a taxa de compartilhamento definida acima.</li>
<li><code>&quot;rpc-password&quot;:</code> <code>coloque_aqui_a_senha</code><br>Senha para acesso remoto. Não se preocupe, ela não é armazenada em texto limpo. Após iniciar o daemon, ela será substituída por um hash.</li>
<li><code>&quot;rpc-username&quot;:</code> <del><code>transmission</code></del> <code>seu_user_desktop</code><br>Login para acesso remoto. É informado com <code>&quot;rpc-password&quot;</code> para gerenciar remotamente o daemon. Pode ser mantido o username <code>transmission</code>, porém prefiro o username do meu usuário cotidiano.</li>
<li><code>&quot;rpc-whitelist-enabled&quot;</code> e <code>&quot;rpc-whitelist&quot;</code><br>Usados para delimitar quais IPs podem acessar o daemon. Eu mantenho a política default (respectivamente, <code>true</code> e <code>&quot;127.0.0.1&quot;</code>) que restringe o acesso à máquina local e realizo o acesso ao daemon a partir do Nginx instalado na máquina - <a href="#secao_nginx">ver abaixo</a> -. Dessa forma, qualquer máquina pode acessar o Transmission (via Nginx) mas sempre utilizando HTTPS.</li>
<li><code>&quot;speed-limit-up&quot;:</code> <del><code>100</code></del> <code>numero_desejado</code><br>Define o limite de upload em Kbps.</li>
<li><code>&quot;speed-limit-up-enabled&quot;:</code> <del><code>false</code></del> <code>true</code><br>Define se o limite de upload está ativo.</li>
<li><code>&quot;umask&quot;:</code> <del><code>18</code></del> <code>2</code><br>Define as permissões de acesso com que serão criados os arquivos e diretórios dos torrents. O valor segue o padrão utilizado pelo <a href="https://pt.wikipedia.org/wiki/Umask" target="_blank" rel="noopener">umask</a> mas escrito em decimal (portanto deve ser convertido para o tradicional octal do umask). O valor default é <code>18</code> (= 022 em octal) e equivale à <code>-rw-r--r--</code> p/ arquivos e <code>drwxr-xr-x</code> p/ dirs (proibe a permissão de escrita para o grupo e outros). Eu prefiro o valor <code>2</code> (= 002 em octal, duh!) que equivale à + permissiva <code>-rw-rw-r--</code> p/ arquivos e <code>drwxrwxr-x</code> p/ dirs (proibe apenas a permissão de escrita para outros).</li>
</ul>
<p>As opções que considero úteis para amenizar a carga sobre o roteador (útil para roteadores com pouca memória, cujo uso de torrents pode afogá-los) são as seguintes: <code>&quot;max-peers-global&quot;</code>, <code>&quot;peer-limit-global&quot;</code>, <code>&quot;peer-limit-per-torrent&quot;</code> e <code>&quot;upload-slots-per-torrent&quot;</code>. Não explicarei cada item, os valores são numéricos e basta diminuir para aliviar a pressão sobre o roteador. Os valores exatos são algo muito pessoal e devem ser experimentados.</p>
<p>O significado dessas 4 últimas opções bem como mais detalhes sobre todas as outras pode ser encontrado na <a href="https://trac.transmissionbt.com/wiki/EditConfigFiles" target="_blank" rel="noopener">documentação oficial</a>.</p>
<h4 id="1-3-Definindo-permissoes-etc"><a href="#1-3-Definindo-permissoes-etc" class="headerlink" title="1.3. Definindo permissões, etc."></a>1.3. Definindo permissões, etc.</h4><p>O daemon é executado com o usuário <code>debian-transmission</code> e grupo <code>debian-transmission</code>. Sendo assim  o diretório definido p/ download (opção <code>&quot;download-dir&quot;</code>) deve ser acessível pelo usuário do daemon.</p>
<p>Por exemplo, altere a propriedade do diretório p/ o usuário e grupo <code>debian-transmission</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chown -R debian-transmission:debian-transmission /dir/dos_downloads_quiridus</span></span><br></pre></td></tr></table></figure>

<p>Se você alterou o valor de <code>umask</code> em <code>settings.json</code> de <code>18</code> p/ <code>2</code>, não apenas o usuário <code>debian-transmission</code> terá permissão de escrita como também os membros do grupo <code>debian-transmission</code>. Para aproveitarmos isso, precisaremos:</p>
<ul>
<li>dar permissões de escrita ao dir de download tb p/ o grupo:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod 775 /dir/dos_downloads_quiridus</span></span><br></pre></td></tr></table></figure>

<ul>
<li>inserir seu usuário cotidiano no grupo <code>debian-transmission</code>:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># usermod -a -G debian-transmission seu_username</span></span><br></pre></td></tr></table></figure>

<p>Pronto, temos o dir de download com as permissões corretas p/ o usuário e grupo <code>debian-transmission</code> e ainda adicionamos seu usuário cotidiano ao grupo <code>debian-transmission</code>, permitindo a ele apagar e etc. o conteúdo desse diretório.</p>
<h3 id="2-Testando-Utilizando"><a href="#2-Testando-Utilizando" class="headerlink" title="2. Testando/Utilizando"></a>2. Testando/Utilizando</h3><h4 id="2-1-Testando"><a href="#2-1-Testando" class="headerlink" title="2.1. Testando"></a>2.1. Testando</h4><p>Reinicie o daemon:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl restart transmission-daemon</span></span><br></pre></td></tr></table></figure>

<p>E acesse o daemon via browser em: <code>127.0.0.1:9091</code> (ou o IP da máquina se você liberou o acesso desde outras máquinas).</p>
<h4 id="2-2-Pos-instalacao"><a href="#2-2-Pos-instalacao" class="headerlink" title="2.2. Pós-instalação"></a>2.2. Pós-instalação</h4><ul>
<li><p>Via browser, vá em <em>Settings</em>, <em>Network</em> e verifique se a porta do torrent (por padrão, 51413) está aberta para à internet. Se não estiver, você deve liberar em seu roteador de casa (foge do escopo desse post, busque pela web :D). Caso não faça isso, a velocidade dos torrents ficará comprometida.</p>
</li>
<li><p>Se a interface via browser acusar erros de permissão de escrita, verifique se o usuário <code>debian-transmission</code> realmente possui as permissões de escrita e leitura adequadas para o diretório definido p/ download.</p>
</li>
</ul>
<h5 id="2-2-1-Problema-da-execucao-precoce-do-transmission-daemon"><a href="#2-2-1-Problema-da-execucao-precoce-do-transmission-daemon" class="headerlink" title="2.2.1. Problema da execução precoce do transmission-daemon"></a>2.2.1. Problema da execução precoce do <code>transmission-daemon</code></h5><p>Se ao ligar a máquina o <code>transmission-daemon</code> sobe antes mesmo do GNU/Linux montar o disco rígido onde estão os dados dos torrents … o transmission não encontrará os arquivos e a atividade dos mesmos ficará paralisada até reiniciarmos o daemon.</p>
<p>A solução para evitar esse problema é fazer o <code>transmission-daemon</code> subir após montar os discos.</p>
<p>A questão é que tive problemas em fazer o daemon obedecer minha vontade na combinação Debian+SystemD. Portanto, a minha solução foi na base da grosseria: alterei o script de execução local (que roda por último) para invocar um script que reinicia o daemon do transmission após 60 segundos. Dessa forma, eliminei o problema de forma burra porém eficaz.</p>
<p>Vejamos minha solução ignorante (se souber forma melhor p/ Debian+SystemD avisa nos comentários):</p>
<p>Crie o arquivo <code>/usr/local/bin/lazy-transmission-daemon.sh</code> com o seguinte conteúdo:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">sleep 60s</span><br><span class="line">systemctl restart transmission-daemon</span><br></pre></td></tr></table></figure>

<p>Torne-o executável:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod +x /usr/local/bin/lazy-transmission-daemon.sh</span></span><br></pre></td></tr></table></figure>

<p>Adicione em <code>/etc/rc.local</code> a linha “<code>/usr/local/bin/lazy-transmission-daemon.sh &amp;</code>“ que invoca nosso novo script no final do boot:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/sh -e</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># rc.local</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This script is executed at the end of each multiuser runlevel.</span></span><br><span class="line"><span class="comment"># Make sure that the script will "exit 0" on success or any other</span></span><br><span class="line"><span class="comment"># value on error.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In order to enable or disable this script just change the execution</span></span><br><span class="line"><span class="comment"># bits.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default this script does nothing.</span></span><br><span class="line"></span><br><span class="line">/usr/<span class="built_in">local</span>/bin/lazy-transmission-daemon.sh &amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>

<h2 id="Protegendo-seu-transmission-daemon-com-HTTPS-Nginx"><a href="#Protegendo-seu-transmission-daemon-com-HTTPS-Nginx" class="headerlink" title="Protegendo seu transmission-daemon com HTTPS (Nginx)"></a><span id="secao_nginx">Protegendo seu <em>transmission-daemon</em> com HTTPS (Nginx)</span></h2><p>Usaremos o <a href="http://nginx.org/" target="_blank" rel="noopener">Nginx</a> para criar um servidor proxy reverso que recebe conexões sobre HTTPS e redireciona para o daemon do Transmission. Isso fará com que a senha e as informações trafeguem entre o client remoto e o servidor de forma criptografada, sendo descriptografadas apenas para trafegar localmente no servidor (entre Nginx e Transmission daemon).</p>
<h3 id="0-Instalacao-do-Nginx"><a href="#0-Instalacao-do-Nginx" class="headerlink" title="0. Instalação do Nginx"></a>0. Instalação do Nginx</h3><p>Instale o Nginx:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get install nginx</span></span><br></pre></td></tr></table></figure>

<h3 id="1-Configuracao-do-Nginx"><a href="#1-Configuracao-do-Nginx" class="headerlink" title="1. Configuração do Nginx"></a>1. Configuração do Nginx</h3><p>Diferente do daemon do Transmission, os arquivos de configuração não são sobrescritos quando o Nginx acaba de executar. Sendo assim, podemos editar o arquivo e simplesmente reiniciar o serviço do Nginx (que já estará em execução automaticamente após a instalação).</p>
<p>Crie o arquivo <code>/etc/nginx/sites-enabled/transmission</code> com o seguinte conteúdo:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  server_name transmission;</span><br><span class="line">  listen 8080 default_server ssl;</span><br><span class="line">  ssl_certificate &#x2F;etc&#x2F;nginx&#x2F;trans.crt;</span><br><span class="line">  ssl_certificate_key &#x2F;etc&#x2F;nginx&#x2F;trans.key;</span><br><span class="line"></span><br><span class="line">  access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;transmission.access.log;</span><br><span class="line"></span><br><span class="line">  location &#x2F; &#123;</span><br><span class="line">    proxy_pass http:&#x2F;&#x2F;localhost:9091;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>O arquivo é bem auto-explicativo. Criaremos um servidor proxy reverso que escutará requisições na porta 8080 usando criptografia e reencaminhará essa requisições para o servidor em <code>http://localhost:9091</code> (o daemon do Transmission).</p>
<p>A explicação detalhada da configuração do Nginx foge ao escopo do post mas na seção de links há documentação sobre o mesmo.</p>
<p>Por fim, gere o certificado utilizado pelo Nginx:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># openssl req -x509 -nodes -new -keyout /etc/nginx/trans.key -out /etc/nginx/trans.crt</span></span><br></pre></td></tr></table></figure>

<p>E reinicie o serviço:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl restart nginx</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Testando-Utilizando-1"><a href="#2-Testando-Utilizando-1" class="headerlink" title="2. Testando/Utilizando"></a>2. Testando/Utilizando</h3><p>Acesse o Transmission normalmente via <code>https://seu_ip:8080</code>. Agora a senha e os dados relativos ao gerenciamento do daemon do Transmission trafegarão de forma segura pela Internet.</p>
<p>Veja a tela do cliente para browsers do Transmission rodando sobre HTTPS:</p>
<img src="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/transmission_com_https_via_browser.png" class="" title="Acessando daemon do Transmission usando https via browser">

<h2 id="Dicas"><a href="#Dicas" class="headerlink" title="Dicas"></a>Dicas</h2><ul>
<li>Em seu computador pessoal utilize o software livre <code>transmission-remote-gtk</code> ao invés do browser. É mais prático que usar o browser, oferecendo uma experiência semelhante à programas de torrent tradicionais.<ul>
<li>Obs: O <code>transmission-remote-gtk</code> atualmente possui bugs abertos relativos à problemas em conectar em serviços usando HTTPS (como o <a href="https://code.google.com/p/transmission-remote-gtk/issues/detail?id=267" target="_blank" rel="noopener">#267</a>). Por hora, estou usando ele apenas quando estou na rede local, acessando diretamente o daemon (sem HTTPS). Para acessar diretamente o daemon, devo adicionar a rede local no whitelist: <code>&quot;rpc-whitelist&quot;: &quot;127.0.0.1, 192.168.*.*&quot;</code></li>
</ul>
</li>
<li>Em seu Android, utilize o software livre <a href="https://f-droid.org/repository/browse/?fdfilter=transdroid&fdid=org.transdroid.full" target="_blank" rel="noopener">Transdroid</a> ao invés do browser. Assim, fica fácil mandar  baixar algo do busão e chegar em casa com o download completo.</li>
</ul>
<h2 id="Arquivos"><a href="#Arquivos" class="headerlink" title="Arquivos"></a>Arquivos</h2><p>Seguem arquivos que talvez ajudem os que se percam na explicação:</p>
<ul>
<li><a href="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/settings-original_json" title="&#x2F;etc&#x2F;transmission-daemon&#x2F;settings.json original">&#x2F;etc&#x2F;transmission-daemon&#x2F;settings.json original</a> do Debian Jessie (renomeie p/ `settings.json`).</li>
<li><a href="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/settings-configurado_json" title="&#x2F;etc&#x2F;transmission-daemon&#x2F;settings.json configurado">&#x2F;etc&#x2F;transmission-daemon&#x2F;settings.json configurado</a>: configuração a partir das recomendações que fiz acima (renomeie p/ `settings.json`). Não esqueça de alterar o usuário e senha p/ acesso (`"rpc-username"` e `"rpc-password"`) assim como path p/ download (`"download-dir"`).</li>
<li><a href="/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/transmission" title="&#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;transmission configurado">&#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;transmission configurado</a> p/ redirecionar requisições sobre HTTPS na porta 8080 p/ servidor em `http://localhost:9091` (o daemon do Transmission).

</li>
</ul>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><h3 id="Transmission"><a href="#Transmission" class="headerlink" title="Transmission"></a>Transmission</h3><ul>
<li><a href="http://www.transmissionbt.com" target="_blank" rel="noopener">Transmission</a>: Site oficial</li>
<li><a href="https://trac.transmissionbt.com/" target="_blank" rel="noopener">trac.transmissionbt</a>: Wiki oficial.<ul>
<li><a href="https://trac.transmissionbt.com/wiki/ConfigFiles" target="_blank" rel="noopener">Configuration Files - trac.transmissionbt</a>: Informações gerais sobre os arquivos de configurações (local, nomes, função, etc.).</li>
<li><a href="https://trac.transmissionbt.com/wiki/EditConfigFiles" target="_blank" rel="noopener">Editing Configuration Files</a>: Informação sobre as opções e como modificar os arquivos de configuração.</li>
</ul>
</li>
<li><a href="https://forum.transmissionbt.com/" target="_blank" rel="noopener">Fórum Transmission</a>: Fórum oficial.</li>
<li><a href="https://blog.flo.cx/2014/03/adding-ssl-to-transmissions-web-interface/" target="_blank" rel="noopener">Adding SSL to transmission’s web interface… | blog.flo.cx</a>: Receita de bolo da mistura Transmission daemon + Nginx.</li>
</ul>
<h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><ul>
<li><a href="http://nginx.org/" target="_blank" rel="noopener">Nginx</a>: Site oficial<ul>
<li><a href="http://nginx.org/en/docs/" target="_blank" rel="noopener">nginx documentation</a>: Documentação oficial.</li>
<li><a href="http://nginx.org/en/docs/beginners_guide.html" target="_blank" rel="noopener">Beginner’s Guide - Nginx</a>: Informação essencial para iniciantes.</li>
<li><a href="http://nginx.org/en/docs/http/configuring_https_servers.html" target="_blank" rel="noopener">Configuring HTTPS servers</a>: Como configurar servidores HTTPS c/ certificado, etc.</li>
</ul>
</li>
<li><a href="http://wiki.nginx.org/Main" target="_blank" rel="noopener">Nginx Community</a>: Wiki comunitária do Nginx.<ul>
<li><a href="http://wiki.nginx.org/Configuration" target="_blank" rel="noopener">Configuration - Nginx Community</a>: Links sobre configuração.</li>
</ul>
</li>
<li>[nginx - ArchWiki](nginx - ArchWiki): Documentação do Arch Linux sobre Nginx. Bem completa.</li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-configure-the-nginx-web-server-on-a-virtual-private-server" target="_blank" rel="noopener">How To Configure The Nginx Web Server On a Virtual Private Server | DigitalOcean</a>: Ótima introdução ao Nginx - explicando sintaxe, etc.</li>
</ul>
<h3 id="Bonus"><a href="#Bonus" class="headerlink" title="Bônus"></a>Bônus</h3><ul>
<li><a href="https://www.youtube.com/watch?v=R1QnXJYT9ao" target="_blank" rel="noopener">Copy is not theft - Nina Paley</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/" data-id="ckabl4ggk0003sgmq4re68h9m" data-title="Torrent profissa: gerenciamento remoto e servidor de compartilhamento 24hs" class="article-share-link">Share</a>
      
        <a href="https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/#disqus_thread" class="article-comment-link">Comments</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/compartilhamento/" rel="tag">compartilhamento</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debian/" rel="tag">debian</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pirataria/" rel="tag">pirataria</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/raspberry/" rel="tag">raspberry</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/torrent/" rel="tag">torrent</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/04/19/criando-particoes-encriptadas-lvm-sobre-luks/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Criando partições encriptadas (LVM sobre LUKS)
        
      </div>
    </a>
  
  
    <a href="/2015/03/14/proteja-seus-dados-backups-faceis-e-seguros-no-desktop-linux/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Proteja seus dados: backups fáceis e seguros no desktop GNU/Linux</div>
    </a>
  
</nav>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
  </div>
</section>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cultura-livre/">cultura livre</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/develop/">develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gnu-linux/">gnu/linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/humanas/">humanas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/offtopic/">offtopic</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/asteroide/" rel="tag">asteroide</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/astronomia/" rel="tag">astronomia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atom/" rel="tag">atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backup/" rel="tag">backup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/compartilhamento/" rel="tag">compartilhamento</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/criptografia/" rel="tag">criptografia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dark-side/" rel="tag">dark side</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debian/" rel="tag">debian</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/desktop/" rel="tag">desktop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ecmascript/" rel="tag">ecmascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fedora/" rel="tag">fedora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firefox/" rel="tag">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flow/" rel="tag">flow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fotografia/" rel="tag">fotografia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullhd/" rel="tag">fullhd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glamour/" rel="tag">glamour</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gnome/" rel="tag">gnome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/historia/" rel="tag">história</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/humanas/" rel="tag">humanas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsx/" rel="tag">jsx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/livros/" rel="tag">livros</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lua/" rel="tag">lua</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/luks/" rel="tag">luks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lvm/" rel="tag">lvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/" rel="tag">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nvidia/" rel="tag">nvidia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/particionamento/" rel="tag">particionamento</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pirataria/" rel="tag">pirataria</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/planeta/" rel="tag">planeta</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxy/" rel="tag">proxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberry/" rel="tag">raspberry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/seguranca/" rel="tag">segurança</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssd/" rel="tag">ssd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/steam/" rel="tag">steam</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thunderbird/" rel="tag">thunderbird</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/torrent/" rel="tag">torrent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trim/" rel="tag">trim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/universidade/" rel="tag">universidade</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/asteroide/" style="font-size: 10px;">asteroide</a> <a href="/tags/astronomia/" style="font-size: 18px;">astronomia</a> <a href="/tags/atom/" style="font-size: 12px;">atom</a> <a href="/tags/backup/" style="font-size: 10px;">backup</a> <a href="/tags/compartilhamento/" style="font-size: 16px;">compartilhamento</a> <a href="/tags/criptografia/" style="font-size: 12px;">criptografia</a> <a href="/tags/dark-side/" style="font-size: 10px;">dark side</a> <a href="/tags/debian/" style="font-size: 20px;">debian</a> <a href="/tags/desktop/" style="font-size: 10px;">desktop</a> <a href="/tags/ecmascript/" style="font-size: 16px;">ecmascript</a> <a href="/tags/fedora/" style="font-size: 12px;">fedora</a> <a href="/tags/firefox/" style="font-size: 10px;">firefox</a> <a href="/tags/flow/" style="font-size: 10px;">flow</a> <a href="/tags/fotografia/" style="font-size: 18px;">fotografia</a> <a href="/tags/fullhd/" style="font-size: 10px;">fullhd</a> <a href="/tags/glamour/" style="font-size: 10px;">glamour</a> <a href="/tags/gnome/" style="font-size: 14px;">gnome</a> <a href="/tags/historia/" style="font-size: 10px;">história</a> <a href="/tags/humanas/" style="font-size: 12px;">humanas</a> <a href="/tags/javascript/" style="font-size: 16px;">javascript</a> <a href="/tags/jsx/" style="font-size: 12px;">jsx</a> <a href="/tags/livros/" style="font-size: 10px;">livros</a> <a href="/tags/lua/" style="font-size: 10px;">lua</a> <a href="/tags/luks/" style="font-size: 10px;">luks</a> <a href="/tags/lvm/" style="font-size: 12px;">lvm</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/nvidia/" style="font-size: 10px;">nvidia</a> <a href="/tags/particionamento/" style="font-size: 12px;">particionamento</a> <a href="/tags/pirataria/" style="font-size: 16px;">pirataria</a> <a href="/tags/planeta/" style="font-size: 12px;">planeta</a> <a href="/tags/proxy/" style="font-size: 10px;">proxy</a> <a href="/tags/raspberry/" style="font-size: 12px;">raspberry</a> <a href="/tags/seguranca/" style="font-size: 10px;">segurança</a> <a href="/tags/ssd/" style="font-size: 10px;">ssd</a> <a href="/tags/steam/" style="font-size: 10px;">steam</a> <a href="/tags/thunderbird/" style="font-size: 10px;">thunderbird</a> <a href="/tags/torrent/" style="font-size: 10px;">torrent</a> <a href="/tags/trim/" style="font-size: 10px;">trim</a> <a href="/tags/universidade/" style="font-size: 12px;">universidade</a> <a href="/tags/web/" style="font-size: 16px;">web</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">julho 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">dezembro 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">julho 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">junho 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">maio 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">março 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">fevereiro 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">junho 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">março 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">janeiro 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">outubro 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">setembro 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">agosto 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">julho 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">maio 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">abril 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">março 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">fevereiro 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/26/monitorando-temperatura-da-cpu-no-gnu-linux/">Monitorando temperatura da CPU no GNU/Linux</a>
          </li>
        
          <li>
            <a href="/2018/12/15/ocrs-de-pdfs-no-gnu-linux-estudando-com-textos-e-nao-prints/">OCRs de PDFs no GNU/Linux: Estudando com textos e não prints</a>
          </li>
        
          <li>
            <a href="/2018/07/25/comentario-sobre-o-livro-sob-tres-bandeiras-anarquismo-e-imaginacao-anticolonial/">Sobre o livro Sob três bandeiras: Anarquismo e imaginação anticolonial</a>
          </li>
        
          <li>
            <a href="/2018/07/02/saturno-e-seus-aneis-desde-floripa/">Saturno e seus anéis desde Floripa</a>
          </li>
        
          <li>
            <a href="/2018/06/23/vesta-o-asteroide-mais-brilhante-do-ceu-desde-floripa/">Vesta, o asteroide mais brilhante do céu, desde Floripa</a>
          </li>
        
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 felipehw<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'felipehwgithubiogit';
  
  var disqus_url = 'https://felipehw.github.io/2015/03/23/torrent-profissa-gerenciamento-remoto-e-servidor-de-compartilhamento-24hs/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  </div>
</body>
</html>
